@model RecoreView;
<div id="app">
    <table class = "table" id="view">
        <thead>
            <tr>
            @foreach(var item in Model.Columns){
                <th>@item.Value</th>
            }
            </tr>
        </thead>
    <tbody>
        <tr v-for="row in records">
            @foreach(var item in Model.Columns){
                <td>{{row.data.@item.Key}}</td>
            }
        </tr>
    </tbody>
    </table>
</div>
<script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
<script type="text/javascript">
    var app = new Vue({
        el: "#app",
        data: {
            columns: [
                @Html.Raw(string.Join(",", Model.Columns.Keys.Select(k => $"'{k}'")))
            ],
            recordType: "@Model.recordType",
            records: [],
        },
        methods: {
            LoadViewData: function () {
                var target = document.querySelector("tbody");
                var request = new XMLHttpRequest();
                request.open("GET", "/data/" + this.recordType + "/")
                request.onreadystatechange = function(){
                    if (request.readyState >= 4){
                        app.records = JSON.parse(request.responseText);
                    }
                };
                request.send();
            }
        },
        mounted: function(){
            this.LoadViewData();
        }

    });
</script>